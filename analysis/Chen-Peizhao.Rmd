---
title: "Recommendations for QANTAS: USA airport infrastucture, and a domestic aircraft storage facility"
subtitle: ETC5512 Assignment 1, Master of Business Analytics
author: Peizhao Chen, 31377203, pche0072@student.monash.edu 
date: 'April 16, 2021'
output: 
  html_document:
    css: monashreport.css
    includes:
      before_body: header.html
---

```{r}
install.packages("naniar")
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      cache=TRUE, 
                      messages=FALSE, 
                      warning=FALSE)
library(tidyverse)
library(ggmap)
library(ggplot2)
library(knitr)
library(naniar)
```


```{r}

setwd("C:/Users/Administrator/Desktop/Monash BA/ETC5512/Assignment/ETC-5512")
Flight_data <- read.csv("data/1067097428_T_ONTIME_REPORTING.csv")

```

```{r}
LAX_DFW_ORIGIN_Data <- Flight_data %>%
  dplyr::select(c(`YEAR`:`ARR_DELAY`)) %>%
         filter(ORIGIN %in% c("LAX","DFW"))

LAX_DFW_ORIGIN_Data[is.na(LAX_DFW_ORIGIN_Data)]<-0
```

```{r}

LAX_DFW_DEST_Data <- Flight_data %>%
  dplyr::select(c(`YEAR`:`ARR_DELAY`)) %>%
         filter(DEST %in% c("LAX","DFW"))

LAX_DFW_DEST_Data[is.na(LAX_DFW_DEST_Data)]<-0                
```

```{r}


SUM_OF_DELAY <- LAX_DFW_ORIGIN_Data %>%
  dplyr::select("ORIGIN",
                "DEP_DELAY",
                "ARR_DELAY")%>%
         pivot_longer(cols = -"ORIGIN",
                      names_to = "DELAY",
                      values_to = "TIME") %>%
         group_by(ORIGIN,DELAY) %>%
         summarise(SUM_OF_DELAY= sum(TIME))

knitr::kable(SUM_OF_DELAY, booktabs = TRUE,
  caption = 'DELAY ')         
    
```

```{r}

SUM_OF_DELAY_ORIGIN <- LAX_DFW_ORIGIN_Data %>%
  dplyr::select("ORIGIN",
                "DEP_DELAY",
                "ARR_DELAY")%>%
         pivot_longer(cols = -"ORIGIN",
                      names_to = "DELAY",
                      values_to = "TIME") %>%
         group_by(ORIGIN,DELAY) %>%
         summarise(SUM_OF_DELAY= sum(TIME))

ggplot(SUM_OF_DELAY_ORIGIN,aes(x=DELAY,
                        y=SUM_OF_DELAY))+
  geom_col()+
  facet_grid(~ORIGIN)+
  ggtitle("Total delay time")
 
```

From the figure and table above show that when LAX and DFW are served as origin,they have apparently different mode.DWF has larger sum of delay both in arr and dep,and sum of delay are positive number which means the number of delay flights is larger than on-time flight.LAX also has larger number of dep delay flights compare with on-time flight,but its ARR delay time is negative that means pilots may drive faster and arrive at destination earlier.

```{r}

SUM_OF_DELAY_DEST <-LAX_DFW_DEST_Data %>%
  dplyr::select("DEST",
                "DEP_DELAY",
                "ARR_DELAY")%>%
         pivot_longer(cols = -"DEST",
                      names_to = "DELAY",
                      values_to = "TIME") %>%
         group_by(DEST,DELAY) %>%
         summarise(SUM_OF_DELAY= sum(TIME))

 ggplot(SUM_OF_DELAY_DEST,aes(x=DELAY,
                        y=SUM_OF_DELAY))+
  geom_col()+
  facet_grid(~DEST)+
  ggtitle("Total delay time") 
```
Similar to the figure 1 ,but in figure 2.The sum of ARR time is even negatively larger when lax served as destination,which means flights are operated more efficient.

```{r}
WEEKLY_Mode_of_Delay <-LAX_DFW_ORIGIN_Data %>%
  dplyr::select("ORIGIN",
                "DAY_OF_WEEK",
                "DEP_DELAY",
                "ARR_DELAY")%>%
         pivot_longer(cols =  'DEP_DELAY':'ARR_DELAY',
                      names_to = "DELAY",
                      values_to = "TIME") %>%
         group_by(ORIGIN,DELAY,DAY_OF_WEEK) %>%
         summarise(SUM_OF_DELAY= sum(TIME))
        
 ggplot(WEEKLY_Mode_of_Delay,aes(x= DAY_OF_WEEK,
                                y= SUM_OF_DELAY,
                                fill= DELAY))+
    geom_col()+ 
    facet_grid(~ ORIGIN)+
    scale_fill_brewer(palette = "Dark2")
   
    
```


## Task 2

Your comparison of domestic storage sites goes here

## Resources

Cite your data sources, and software used here

R Core Team (2021). R: A language and environment for
statistical computing. R Foundation for Statistical
Computing, Vienna, Austria. URL
https://www.R-project.org/.

## Supplementary information

Any material that you think is important to include, but does not fit well in the main report can go here. The marker will likely not look at this section. So choose carefully, anything important needs to be in sections 1 (Task 1) and 2 (Task 2).
